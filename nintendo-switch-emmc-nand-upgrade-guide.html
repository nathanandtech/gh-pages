<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Nintendo Switch EMMC nand upgrade guide - nathanandtech</title><meta name="description" content=" First, Thanks to Paul for all his help and patience and the [guide](http://pascoe.pw/2018/09/switchnand.html) this is based and thanks to bnstemp from http://bbs.duowan.com/forum.php?mod=viewthread&amp;tid=46505080&amp;from=singlemessage for his additional work. Paul's guide did a great job on the hardware side, and in fact I ended up sending off&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://nathanbunn.com/nintendo-switch-emmc-nand-upgrade-guide.html"><link rel="alternate" type="application/atom+xml" href="https://nathanbunn.com/feed.xml"><link rel="alternate" type="application/json" href="https://nathanbunn.com/feed.json"><meta property="og:title" content="Nintendo Switch EMMC nand upgrade guide"><meta property="og:site_name" content="nathanandtech"><meta property="og:description" content=" First, Thanks to Paul for all his help and patience and the [guide](http://pascoe.pw/2018/09/switchnand.html) this is based and thanks to bnstemp from http://bbs.duowan.com/forum.php?mod=viewthread&amp;tid=46505080&amp;from=singlemessage for his additional work. Paul's guide did a great job on the hardware side, and in fact I ended up sending off&hellip;"><meta property="og:url" content="https://nathanbunn.com/nintendo-switch-emmc-nand-upgrade-guide.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://nathanbunn.com/assets/css/style.css?v=c37594acf579eddd689835749263c87b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://nathanbunn.com/nintendo-switch-emmc-nand-upgrade-guide.html"},"headline":"Nintendo Switch EMMC nand upgrade guide","datePublished":"2019-01-31T18:57","dateModified":"2020-07-19T18:57","description":" First, Thanks to Paul for all his help and patience and the [guide](http://pascoe.pw/2018/09/switchnand.html) this is based and thanks to bnstemp from http://bbs.duowan.com/forum.php?mod=viewthread&amp;tid=46505080&amp;from=singlemessage for his additional work. Paul's guide did a great job on the hardware side, and in fact I ended up sending off&hellip;","author":{"@type":"Person","name":"Nathan"},"publisher":{"@type":"Organization","name":"Nathan"}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://nathanbunn.com/">nathanandtech</a></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2019-01-31T18:57">January 31, 2019</time></div><h1>Nintendo Switch EMMC nand upgrade guide</h1><div class="post__meta post__meta--author"><a href="https://nathanbunn.com/authors/nathan/" class="feed__author invert">Nathan</a></div></div></header></div><div class="wrapper post__entry"><p>First, Thanks to Paul for all his help and patience and the [guide](http://pascoe.pw/2018/09/switchnand.html) this is based and thanks to bnstemp from http://bbs.duowan.com/forum.php?mod=viewthread&amp;tid=46505080&amp;from=singlemessage for his additional work.<br><br>Paul's guide did a great job on the hardware side, and in fact I ended up sending off to a pro to get the EMMC chipped switched over, so I wont go over that here. I will start this guide presuming you have a 256 EMMC already soldered onto your replacement daughter board.<br><br>The 256GB chip I used is a sandisk model,sold as [SDINBDA4-256G](https://item.taobao.com/item.htm?spm=a1z09.2.0.0.516f2e8d0fx1dW&amp;id=582577399024&amp;_u=320k5lp00340)<br>This was the only one I could find in stock, in single chip amounts.<br><br>I will also presume you understand switch CFM, RCM, payload sending etc, and have a working hekate SD card. There are great switch CFW setup guides out there already if not so I suggest you read them.<br>I will also assume basic Linux Knowledge, I won't go over making a Ubuntu Live USB, etc, but trust Google to help if anyone gets stuck.<br><br>## Preparation<br><br>The first thing you need to do is make a full backup of your current EMMC. Boot into Hekate, and under tools - backup boot0/1 and raw nand onto your micro SD card. I recommend a 64GB+ micro SD here, so you get a nice single backup file, with plenty of space.<br>You will also need to get your bis_key_03. This is a console specific key which you can get use lockpick, or biskeydump.bin from RCM mode and then opening the prod.keys file or similar on your PC.<br>You need this to read the switch user partition from windows later on.<br><br>## Hardware<br><br>Open your switch, i followed the iFixit guide. Remove the back, then the SD card reader, and then the shiny metal shield under it, then you need simply need to use a plastic prying tool to lift up the EMMC board, careful as there is double sided tape holding it down, and replace it with your new board. I replaced the double sided tape too just incase.<br><br>Then put your switch back together again, following the iFixit guide in reverse.<br><br>## Software<br><br>Once you have it all back together, then boot Johns custom version of [hakate](http://pascoe.pw/2018/09/no-backup-sizecheck-hekate.bin), linked in the above guide, and under show hardware, check that EMMC is detected. This makes sure your soldering was good and the EMMC is working.<br><br>Now remove your SD card and put it in your PC, copy boot0,1 and rawnand.bin into the backup/xxxx/restore folder. where xxxx is a random folder name for your switch.<br><br>The put the SD card back into the switch, and go to tools, restore, and restore boot0/1 and then restore rawnand.bin. This will take a while to copy over and then verify, get a cup of tea and come back later.<br><br>Once this process is finished, you can shutdown your switch, then try booting normally. You should be able to load into the switch system, and all your data should be there, however the disk will still only show 26GB, like before, we need to expand the partition to fill the new drive.<br>However since the drive is encrypted, we cannot just wipe it and remake it, we need to both expand the partition, and then format the partition inside the encryption to get the switch to see the new extended size.<br><br>For this process you need a linux PC/linux USB bootdisk (ubuntu recommended), and then a windows PC to open the encrypted partition and format it to FAT32.<br>You will also need the [memloader](https://switchtools.sshnuke.net/) payload, to make the switch emmc be seen over USB by the PC, and also later on hacdiskmount from the same site for windows.<br><br>First send the memloader payload to your switch as you normally would, the switch will show some text and offer options of what to mount.<br><br>## On a Linux Machine.<br><br>Now boot into Linux, and open a root terminal. At the terminal type<br><br>fdisk -l<br><br>to list all connected hardrives and storage media. Make a note of the letters available, /dev/sda, /dev/sdb etc.<br><br>Next connect your switch to the linux PC via USB, and using the volume keys on the switch highlight the EMMC option and press the power button to select and mount the EMMC partition on the linux machine.<br><br>Now run fdisk -l again to show all the hardrives connected to your PC, and notice which one of the same size as your new drive, was not there before. This is the drive you are working on, be very careful to get this right, as any mistake here can cause irreparable damage to your windows install.<br>You are looking for the drive with 11 partitions, the first 9 being small, then one 2.5GB, then the final 11th being 26GB. All of type unknown.<br>See a copy of my partition layout for the switch EMMC below.<br><br>Disk /dev/sdb: 233 GiB, 250148290560 bytes, 488570880 sectors<br>Units: sectors of 1 * 512 = 512 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disklabel type: gpt<br>Disk identifier: EDD7049E-B2D3-4067-B3D9-E5A8F398258F<br><br>Device Start End Sectors Size Type<br>/dev/sdb1 34 8191 8158 4M unknown<br>/dev/sdb2 8192 16383 8192 4M unknown<br>/dev/sdb3 16384 32767 16384 8M unknown<br>/dev/sdb4 32768 49151 16384 8M unknown<br>/dev/sdb5 49152 65535 16384 8M unknown<br>/dev/sdb6 65536 81919 16384 8M unknown<br>/dev/sdb7 81920 98303 16384 8M unknown<br>/dev/sdb8 98304 114687 16384 8M unknown<br>/dev/sdb9 114688 245759 131072 64M unknown<br>/dev/sdb10 245760 5488639 5242880 2.5G unknown<br>/dev/sdb11 5488640 60014591 54525952 26G unknown<br><br>For me this was /dev/sdb, for the rest of the guide i will write /dev/sdX to remind you to substitute whichever drive letter your switch was assigned.<br><br>gdisk /dev/sdx<br><br>this opens the gdisk application, and points it at your switch emmc. If you are offered the chance to correct the start position of the drive or the partition table, press y to accept.<br><br>i 11<br><br>Type i, enter, then 11 to show the information for the 11th partition on the drive. Including the GUID, and the unique GUID, we need to mirror all these fields exactly later.<br>Copy all this information into a text editor for easier copy and pasting later.<br><br>Mine looked like this:<br><br>Partition number (1-11): 11<br>Partition GUID code: 2B777F63-E842-47AF-94C4-25A7F18B2280 (Unknown)<br>Partition unique GUID: 5561E2C3-9B40-4D90-A546-20EB6C0151FC<br>First sector: 5488640 (at 2.6 GiB)<br>Last sector: 60014591 (at 28.6 GiB)<br>Partition size: 54525952 sectors (26.0 GiB)<br>Attribute flags: 0000000000000001<br>Partition name: 'USER'<br><br>Next we need to delete the 11th partition, the user partition, don't worry, this wont delete the data underneath (although remember you also have the backup of your nand anyway incase something goes wrong).<br>In gdisk with your switch nand selected type:<br><br>d 11<br><br>to delete the partition. Then write these changes to the disk with<br><br>w<br><br>you will see the following warning:<br>"Warning! Secondary header is placed too early on the disk! Do you want to<br>correct this problem? (Y/N):"<br>Enter y, then y again on the final check to write those changes to the disk.<br><br>We now need to refresh the partition layout with kpartx, so enter<br><br>kpartx /dev/sdX<br><br>which will refresh the partition layout, updating it with the new changes in size and layout.<br><br>Now re-enter gdisk, making sure to specify the switch emmc from before.<br><br>gdisk /dev/sdX<br><br>Now create a new partition, in the exact same place as the one we just deleted,<br><br>Command (? for help): n<br><br>the tool will automatically use partition 11, and accept the default for start and end location, noting that the end location is now your new disk size, 6xxxxxx for 64gb, 11xxxxx for 128gb and 24xxxxxx for 240GB.<br><br>When prompted for the partition type, copy and paste the partition GUID we made a note of earlier. (not the one labeled unique GUID). The one that ends in (UNKNOWN). For me that was Partition GUID code: 2B777F63-E842-47AF-94C4-25A7F18B2280 (Unknown)<br><br>Now the new partition is created, we need to change the partitions unique GUID code back to the same as it was before, so the switch knows which partition to use.<br>We do this by typing<br><br>x c 11<br><br>x, to enter advanced mode, c for change partition GUID, and 11 for the USER partition we are working with.<br>The prompt will change to<br><br>Enter the partition's new unique GUID ('R' to randomize):<br><br>and here we enter the unique GUID for the partition that we made a note of before. ( for me it is 'Partition unique GUID: 5561E2C3-9B40-4D90-A546-20EB6C0151FC')<br><br>We also need to set the partition name, so press m for the main menu<br><br>m<br><br>then c for change partition name, 11 for the partition to change, and then set the name to USER in capital letters.<br><br>c 11<br>USER<br><br>Finally we need to set the attributes for the partition, to set it back to system so that the switch won't notice we were here.<br>x for advanced, then a for attributes, and 11 to chose the partition, and then toggle attribute 0 to set the partition to system.<br><br>Expert command (? for help): a<br>Partition number (1-11): 11<br>Known attributes are:<br>0: system partition<br>1: hide from EFI<br>2: legacy BIOS bootable<br>60: read-only<br>62: hidden<br>63: do not automount<br><br>Attribute value is 0000000000000000. Set fields are:<br>No fields set<br><br>Toggle which attribute field (0-63, 64 or<enter>to exit): 0<br>Have enabled the 'system partition' attribute.<br>Attribute value is 0000000000000001. Set fields are:<br>0 (system partition)<br><br>Toggle which attribute field (0-63, 64 or<enter>to exit):<br><br>press enter to exit.<br><br>We are all done here, but finally we can print the partition information again with<br><br>i 11<br><br>and compare this with the values we saw originally, it should be identical except for the lat sector and partition size fields, which should represent the new size. If any of these are different go back now and double check your work until they match exactly.<br>Once you are done enter w to write, and y that you are sure.<br><br>w y<br><br>Now you can unplug your switch, press the power button for 5 seconds to exit memloader and then press the power button to boot your switch.<br>It should boot normally into the switch OS, with all your saves and content preserved from before.<br>##If at this point you have any errors, or the switch won't boot, go back and try the steps again right from restore your rawnand.bin, as if it wont boot correctly now, the next steps won't fix that.<br><br>Now we need access to a windows PC with HacDiskMount and fat32format.exe.<br><br>## On a windows PC.<br><br>Shutdown your switch and reboot to RCM mode. Push the memloader payload again, connect the cable to your windows PC, and using volume and power mount the EMMC partition over USB.<br><br>In windows open HacDiskMount as administrator, click file and open physical drive. Choose your switch drive, ignore the error that it does not seem like a full emmc dump.<br>You should see the 11 partitions listed here, click the USER partition we just remade, and you will see a prompt for encryption keys.<br>Take the bis_key_03 value from your prod.keys that you dumped earlier, and enter the left half on the top line, and the right half on the line below, then click test. You should see a message that the was successful and the encryption was opened.<br>If you do not get a success message stop now, and double check/redump your prod.keys. If you continue without opening the encryption you lose all your switch data.<br><br>Once the keys are verified, install the driver, and mount the drive to an empty drive letter. In this example i will use the G: drive.<br><br>Open windows explorer and copy all the files from the G drive onto your local machine, this is a backup of your saves and settings, do not lose this.<br><br>Now we need to go to the location where fat32format.exe is located, run an administrator prompt and enter<br>fat32format.exe G:<br><br>This will wipe your switch user partition and reformat it, using the new partition data we created to give us the full size of the new USER partition.<br>Once this finished we now should see the new EMMC size in windows explorer for the G drive, and we can copy back our backup of the saves and settings we made before the format. This copy is slow, and if it fails I recommend deleting all the files and re-copying folder by folder until it completes successfully.<br><br>Wait 30 seconds for any background file transfers to complete, then in HacDiskMount unmount the drive, and after a few seconds disconnect your switch.<br><br>Hold the power button on your switch for 5 seconds to exit memloader, then cross your fingers and press the power button, the switch should boot up normally, but in the settings menu, show your new EMMC size. Success!<br>If you get a black nintendo error screen, go back to the rawnand.bin stage and start the whole process again, it may take a couple of tries for the stars to align and every step to go flawlessly.<br><br>Enjoy your new switch storage space!<br><br></enter></enter></p><figure class="post__image post__image--center"><img loading="lazy" src="https://nathanbunn.com/media/posts/5/250done-2.jpg" sizes="(max-width: 48em) 100vw, 768px" srcset="https://nathanbunn.com/media/posts/5/responsive/250done-2-xs.jpg 300w, https://nathanbunn.com/media/posts/5/responsive/250done-2-sm.jpg 480w, https://nathanbunn.com/media/posts/5/responsive/250done-2-md.jpg 768w, https://nathanbunn.com/media/posts/5/responsive/250done-2-lg.jpg 1024w, https://nathanbunn.com/media/posts/5/responsive/250done-2-xl.jpg 1360w, https://nathanbunn.com/media/posts/5/responsive/250done-2-2xl.jpg 1600w" height="3120" width="4160" alt=""></figure></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on July 19, 2020</p><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://nathanbunn.com/authors/nathan/" class="invert" rel="author">Nathan</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://nathanbunn.com/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://nathanbunn.com/switch-to-256.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Switch to 256</a></div><div class="post__nav-next"><a href="https://nathanbunn.com/unlocking-the-bios-whitelist-and-advanced-menu-on-my-x230-w530-and-lenovo-x1-carbon-2014.html" class="invert post__nav-link" rel="next"><span>Next</span> Unlocking the bios whitelist and advanced menu on my x230, w530 and Lenovo X1 carbon 2014 </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://nathanbunn.com/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2019-01-30T18:54" class="feed__date">January 30, 2019</time></div><h3 class="h1"><a href="https://nathanbunn.com/switch-to-256.html" class="invert">Switch to 256</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2019-01-29T18:51" class="feed__date">January 29, 2019</time></div><h3 class="h1"><a href="https://nathanbunn.com/upgrading-my-switch-emmc-to-128gb.html" class="invert">Upgrading my switch EMMC to 128GB</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p>Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii Static CMS</a></p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://nathanbunn.com/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://nathanbunn.com/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>